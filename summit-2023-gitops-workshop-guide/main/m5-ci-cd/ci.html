<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Making a Code Change and Triggering the Continuous Integration (CI) Process :: GitOps Workshop Guide</title>
    <link rel="prev" href="deploy.html">
    <link rel="next" href="cd.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
      const urlParams = new URLSearchParams(window.location.search);
      const userId = urlParams.get('USERID');
      const subDomain = urlParams.get('SUBDOMAIN');
      const apiUrl = urlParams.get('APIURL');
      if (userId) {
        showUserId( userId );
      }
      else {
        showUserIdForm();
      }
    } );


    function showUserId( userId ) {
      document.getElementById('navbar-form-empty').style.display = "none";
      document.getElementById('navbar-form-filled').style.display = "flex";
      document.getElementById('username').textContent = userId;
      document.getElementById('subDomain').value = subDomain;
      document.getElementById('apiUrl').value = apiUrl;

    }

    function showUserIdForm( userId ) {
      document.getElementById('navbar-form-empty').style.display = "flex";
      document.getElementById('navbar-form-filled').style.display = "none";
    }

    function goWithUserId() {
      elUserIdInput = document.getElementById('userId');
      elSubDomainInput = document.getElementById('subDomain');
      elapiUrlInput = document.getElementById('apiUrl');

      window.location.search = ('&USERID=' + elUserIdInput.value + '&SUBDOMAIN=' + elSubDomainInput.value + '&APIURL=' + elapiUrlInput.value);
    }

  </script>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com/en/technologies/cloud-computing/openshift" target="_blank"><img
          src="../../../_/img/Logo-Red_Hat-OpenShift_4-A-Reverse-RGB.png" height="40px" alt="Red Hat OpenShift"></a>
      <a class="navbar-item" href="../../.." style="color: white;"><h3>GitOps Workshop Guide</h3></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item" id="navbar-form-empty">
          <span class="navbar-text" style="margin-left: 1rem;">Your Workshop Environment</span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i style="color: orange;"
              class="fa fa-exclamation-triangle" aria-hidden="true"></i></span>

          <form action="javascript:void(0);" onsubmit="goWithUserId();">
            <div class="navbar-item" id="navbar-form-project-filled" style="display: none;">
              <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">|</span>
            </div>
            <input size="40" id="userId" type="text" placeholder="Enter GitHub Org/Username">
            <input type="hidden" id="subDomain" name="subDomain" value="">
            <input type="hidden" id="apiUrl" name="apiUrl" value="">
          </form>
        </div>

        <div class="navbar-item" id="navbar-form-filled" style="display: none;">
          <span class="navbar-text" style="margin-left: 1rem;">Your Workshop Environment</span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">|</span>
          <span class="navbar-text" id="username"></span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i onclick="recycle();" style="color: green;" class="fa fa-recycle" aria-hidden="true"></i></span>
        </div>

    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="summit-2023-gitops-workshop-guide" data-version="main">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../m1-overview/intro.html" class=" query-params-link">GitOps Workshop Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module One: Overview &amp; Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m1-overview/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m1-overview/setup.html">Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module Two:  GitOps First Steps</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m2-argocd-introduction/accessing-argocd.html">Accessing the Cluster GitOps Dashboard</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m2-argocd-introduction/first-steps-with-argocd.html">First Steps with GitOps using Argo CD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m2-argocd-introduction/self-healing.html">Argo CD Self-Healing Capabilities</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module Three: Managing Namespaces &amp; RBAC</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m3-managing-namespaces/kustomize.html">Using Kustomize for Templating YAML</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m3-managing-namespaces/create-applications-using-kubectl.html">Create Applications using the CLI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m3-managing-namespaces/granting-service-account-permission.html">Argo CD Service Account Permissions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m3-managing-namespaces/rbac-for-namespaces.html">RBAC for Namespaces</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module Four: Argo CD Projects &amp; App of Apps</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m4-argocd-projects/rbac-demo.html">Exploring Projects &amp; RBAC</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m4-argocd-projects/app-of-apps.html">The App of Apps</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../m4-argocd-projects/verify-rbac.html">Verify &amp; Understand your Work</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module Five: Continuous Delivery of an Application</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="deploy.html">Setup</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="ci.html">Continuous Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cd.html">Continuous Delivery</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">GitOps Workshop Guide</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">GitOps Workshop Guide</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../m1-overview/intro.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../m1-overview/intro.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../m1-overview/intro.html">GitOps Workshop Guide</a></li>
    <li>Module Five: Continuous Delivery of an Application</li>
    <li><a href="ci.html">Continuous Integration</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/summit-2023-gitops-lab-guide/edit/main/docs/modules/m5-ci-cd/pages/ci.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Making a Code Change and Triggering the Continuous Integration (CI) Process</h1>
<div class="paragraph">
<p>Nice work on getting the application deployed on OpenShift! Now you&#8217;ll make a change to the application&#8217;s development environment configuration, verify it passes CI, merge the change into the <code>main</code> branch and watch as Argo CD detects and applies the new change.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Head over to your copy of the random-meme application repository: <a href="https://github.com/%USERID%/rht-summit-2023-sample-application">github.com/%USERID%/rht-summit-2023-sample-application</a>.</p>
</li>
<li>
<p>Use the period/dot key as a shortcut to open the GitHub IDE.</p>
</li>
<li>
<p>Once the GitHub IDE has loaded:</p>
<div class="ulist">
<ul>
<li>
<p>Click the branch name (<code>main</code> by default) in the bottom left.</p>
</li>
<li>
<p>Select <strong>Create new branch</strong> in the popup that appears.</p>
</li>
<li>
<p>Enter the follwoing branch name and press the enter key: <code>new-meme</code></p>
</li>
<li>
<p>Click the green <strong>Switch to branch</strong> button when promoted.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use the following image as a guide for completing the prior steps:</p>
<div class="paragraph">
<p><span class="image"><img src="_images/ex8.gh-new-branch.png" alt="ex8.gh new branch"></span></p>
</div>
</li>
<li>
<p>Add a new image to the <em>k8s/overlays/development/config-map.yaml</em> file. You can use the URL of any image that you like.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The URL of the image must resolve to an image file, and not a page that contains the image. If the URL ends in an extension such as <code>.png</code> or <code>.jpg</code> then it&#8217;ll likely resolve directly to an image.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the <strong>Source Control</strong> view from the side-menu.</p>
</li>
<li>
<p>Enter a commit message and push your change using the <strong>Commit &amp; Push</strong> button.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/ex8.gh-diff-commit.png" alt="ex8.gh diff commit"></span></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This new branch can be used to create a pull request. Creating the pull request will invoke a CI process, after which the code change can be merged to the <code>main</code> branch.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It&#8217;s common to use a <a href="https://trunkbaseddevelopment.com/">trunk-based development model</a> with Argo CD. That&#8217;s why your pull request will target the <code>main</code> branch, and not a <code>development</code> or <code>staging</code> branch. The <em>k8s/overlays</em> directory contains a unique configuration for each environment. Since the application is containerised, each of the <em>k8s/overlays</em> (i.e environments) can be updated to point to a specific container image tag. This alleviates the need to have branches with varying configurations that result in tedious Git merges at a later point in time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Return to <a href="https://github.com/%USERID%/rht-summit-2023-sample-application">your copy random-meme application repository</a>.</p>
</li>
<li>
<p>It should display a message that your <code>new-meme</code> branch had changes, and it suggests opening a pull request.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/ex8.gh-pr-notice.png" alt="ex8.gh pr notice"></span></p>
</div>
</li>
<li>
<p>Click on the <strong>Compare &amp; pull request</strong> button.</p>
</li>
<li>
<p>On the <strong>Open a pull request</strong> screen, scroll down and click the <strong>Create pull request</strong> button.</p>
</li>
<li>
<p>Approve the pending checks if prompted, then wait for them to complete.</p>
</li>
<li>
<p>Do not merge the pull request yet!</p>
<div class="paragraph">
<p><span class="image"><img src="_images/ex8.gh-pr-open.png" alt="ex8.gh pr open"></span></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the CI check fails, it most likely means that a URL you added to the ConfigMap doesn&#8217;t resolve to an image or there&#8217;s a syntax error in the JSON array in the ConfigMap. Make sure that your chosen URL returns an image and <strong>not a page that contains an image</strong> since that will fail the CI check. Another thing to be aware of is to make sure the image URL in the ConfigMap is surrounded by quotes, and that you haven&#8217;t misplaced a comma.</p>
</div>
<div class="paragraph">
<p>Once the CI checks have passed move on to the next section.</p>
</div>
<nav class="pagination">
  <span class="prev"><a href="deploy.html" class="query-params-link">Setup</a></span>
  <span class="next"><a href="cd.html" class="query-params-link">Continuous Delivery</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<script src="../../../_/js/vendor/clipboard.js"></script>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
